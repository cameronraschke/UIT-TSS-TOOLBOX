#!/usr/bin/php
<?php
include('/var/lib/UIT-TSS-TOOLBOX/DB-connect-local.php');
?>

<html>
    <head>
        <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-size: 1em;
            content-align: center;
            font-family: sans-serif;
        }

        .styled-form2 input[type=submit] {
            padding: 8px 10px;
        }

        .clienttable,
        .infotable {
            position: relative;
            display: flex;
            width: 50%;
            height: auto;
            top: 10%;
            left: 35%;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
            border-bottom: 2px solid #BE77D6;
            margin: 2% 2% 2% 2%;
            overflow: auto;
        }
        .servertable {
            display: flex;
            position: absolute;
            width: 25%;
            height: auto;
            top: 17%;
            left: 5%;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
            border-bottom: 2px solid #BE77D6;
            margin: 2% 2% 2% 2%;
            overflow: auto;
        }

        .styled-table {
            position: relative;
            width: 100%;
            border-collapse: collapse;
        }
        .styled-table thead tr {
            background-color: #BE77D6;
            color: #ffffff;
            text-align: left;
        }
        .styled-table th,
        .styled-table td {
            padding: 12px 15px;
        }
        .styled-table tbody tr {
            border-bottom: 1px solid #dddddd;
        }
        .styled-table tr:nth-child(odd) td{
            background-color: #F2F2F2;
        }

        .menubar {
            position: relative;
            width: 100%;
            top: 0%;
            background-color: #EBDDEF;
            padding: 1% 5%;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
        }

        .menubar button {
            padding: 8px 10px;
            margin: 1% 1% 1% 1%;
        }
</style>
</head>
    <body>
        <?php
            /* echo "<div class=\"clienttable\">";
            echo "<table class=\"styled-table\"";
            echo "<tr>";
            echo "<th>Tag Number</th>";
            echo "<th>Date</th>";
            echo "<th>Ethernet Address</th>";
            echo "<th>Disk</th>";
            echo "<th>Action</th>";
            echo "<th>Total Time</th>";
            echo "<th>Clone Time</th>";
            echo "<th>Clone Image</th>";
            echo "<th>Clone Master</th>";
            echo "<th>Last Image Update</th>";
            echo "<th>Clone Mode</th>";
            echo "<th>Clone Completed</th>";
            echo "<th>Erase Time</th>";
            echo "<th>Erase Mode</th>";
            echo "<th>Erase Completed</th>";
            echo "</tr>";
            $sql = "SELECT tagnumber,date,etheraddress,disk,action,all_totaltime,clone_time,clone_image,clone_master,clone_imageupdate,";
            $sql .= "clone_mode,clone_completed,erase_time,erase_mode,erase_completed FROM jobstats";
            $results = $conn->query($sql);
            while ($row = $results->fetch_array(MYSQLI_ASSOC)) {
                $tagnumber = $row['tagnumber'];
                $date = $row['date'];
                $etheraddress = $row['etheraddress'];
                $disk = $row['disk'];
                $action = $row['action'];
                $all_totaltime = $row['all_totaltime'];
                $clone_time = $row['clone_time'];
                $clone_image = $row['clone_image'];
                $clone_master = $row['clone_master'];
                $clone_imageupdate = $row['clone_imageupdate'];
                $clone_mode = $row['clone_mode'];
                $clone_completed = $row['clone_completed'];
                $erase_time = $row['erase_time'];
                $erase_mode = $row['erase_mode'];
                $erase_completed = $row['erase_completed'];

                echo "<tr>";
                echo "<td>$tagnumber</td>";
                echo "<td>$date</td>";
                echo "<td>$etheraddress</td>";
                echo "<td>$disk</td>";
                echo "<td>$action</td>";
                echo "<td>$all_totaltime</td>";
                echo "<td>$clone_time</td>";
                echo "<td>$clone_image</td>";
                echo "<td>$clone_master</td>";
                echo "<td>$clone_imageupdate</td>";
                echo "<td>$clone_mode</td>";
                echo "<td>$clone_completed</td>";
                echo "<td>$erase_time</td>";
                echo "<td>$erase_mode</td>";
                echo "<td>$erase_completed</td>";
                echo "</tr>";
            }
            echo "</table>";
            echo "</div>"; */

            echo "<div class=\"clienttable\">";
            echo "<table class=\"styled-table\"";
            echo "<tr>";
            echo "<th>Tag Number</th>";
            echo "<th>Device Type</th>";
            echo "<th>Last Job Date</th>";
            echo "<th>All Jobs Avg. Time</th>";
            echo "<th>Erase Jobs Avg. Time</th>";
            echo "<th>Clone Jobs Avg. Time</th>";
            echo "<th>Total Jobs</th>";
            echo "<th>Erase Jobs</th>";
            echo "<th>Clone Jobs</th>";
            echo "</tr>";

            $sql = "SELECT * FROM clientstats WHERE NOT tagnumber = '000000' ORDER BY date DESC";
            $results = $conn->query($sql);
            while ($row = $results->fetch_array(MYSQLI_ASSOC)) {
                $tagnumber = $row['tagnumber'];
                $device_type = $row['device_type'];
                $last_job_date = $row['last_job_date'];
                $all_avgtime = $row['all_avgtime'];
                $erase_avgtime = $row['erase_avgtime'];
                $clone_avgtime = $row['clone_avgtime'];
                $all_jobs = $row['all_jobs'];
                $erase_jobs = $row['erase_jobs'];
                $clone_jobs = $row['clone_jobs'];
                
                echo "<tr>";
                echo "<td>$tagnumber</td>";
                echo "<td>$device_type</td>";
                echo "<td>$last_job_date</td>";
                echo "<td>$all_avgtime</td>";
                echo "<td>$erase_avgtime</td>";
                echo "<td>$clone_avgtime</td>";
                echo "<td>$all_jobs</td>";
                echo "<td>$erase_jobs</td>";
                echo "<td>$clone_jobs</td>";
                echo "</tr>";

            }

            echo "</table>";
            echo "</div>";

            echo "<div class=\"servertable\">";
            echo "<table class=\"styled-table\"";
            echo "<tr>";
            echo "<th>Date</th>";
            echo "<th>Laptop Count</th>";
            echo "<th>Last Image Update</th>";
            echo "<th>Total Jobs</th>";
            echo "<th>Erase Jobs</th>";
            echo "<th>Clone Jobs</th>";
            echo "<th>Clone Avg. Time</th>";
            echo "<th>NVME Avg. Erase Time</th>";
            echo "<th>SSD Avg. Erase Time</th>";
            echo "</tr>";

            $sql = "SELECT * FROM serverstats ORDER BY date DESC";
            $results = $conn->query($sql);
            while ($row = $results->fetch_array(MYSQLI_ASSOC)) {
                $date = $row['date'];
                $laptop_count = $row['laptop_count'];
                $last_image_update = $row['last_image_update'];
                $all_jobs = $row['all_jobs'];
                $erase_jobs = $row['erase_jobs'];
                $clone_jobs = $row['clone_jobs'];
                $clone_avgtime = $row['clone_avgtime'];
                $nvme_erase_avgtime = $row['clone_avgtime'];
                $ssd_erase_avgtime = $row['clone_avgtime'];

                echo "<tr>";
                echo "<td>$date</td>";
                echo "<td>$laptop_count</td>";
                echo "<td>$last_image_update</td>";
                echo "<td>$all_jobs</td>";
                echo "<td>$erase_jobs</td>";
                echo "<td>$clone_jobs</td>";
                echo "<td>$clone_avgtime</td>";
                echo "<td>$nvme_erase_avgtime</td>";
                echo "<td>$ssd_erase_avgtime</td>";
                echo "</tr>";
            }
            
            echo "</table>";
            echo "</div>";
        ?>
</body>
</html>

<?php
$conn->close();
?>
