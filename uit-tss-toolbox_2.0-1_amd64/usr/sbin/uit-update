#!/bin/bash

if [[ "$EUID" > 0 ]]; then 
  echo "Please run as root. Exiting..."
  exit 1
fi

if [[ ! -f /home/cameron/.uit-passwd ]]; then
  echo "/home/cameron/.uit-passwd is missing. Exiting..."
  echo "Make sure all variables in .uit-password are set."
  exit 1
fi

read -p "Download from GitHub? [Y/n]: " gitBool

if [[ -z $gitBool || $gitBool == "y" || $gitBool == "Y" ]]; then
  rm -r /tmp/uit-toolbox/
  git clone https://github.com/cameronraschke/UIT-TSS-TOOLBOX /tmp/uit-toolbox/
fi

if [[ -d /tmp/uit-toolbox/uit-tss-toolbox_2.0-1_amd64 ]]; then
  dpkg --purge uit-toolbox
fi

chmod 755 /tmp/uit-toolbox/uit-tss-toolbox_2.0-1_amd64/DEBIAN/postinst
dpkg-deb --build /tmp/uit-toolbox/uit-tss-toolbox_2.0-1_amd64/ /tmp/uit-toolbox/uit-tss-toolbox_2.0-1_amd64.deb
dpkg --install /tmp/uit-toolbox/uit-tss-toolbox_2.0-1_amd64.deb

