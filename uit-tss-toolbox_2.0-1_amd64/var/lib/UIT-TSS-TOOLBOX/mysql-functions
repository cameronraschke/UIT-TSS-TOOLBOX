#!/usr/bin/php
<?php

require('/var/lib/UIT-TSS-TOOLBOX/PDO-connect');
require('/var/lib/UIT-TSS-TOOLBOX/functions');


function dbSelect ($sql) {
    clearArray();
    global $pdo;
    global $arr;
    $arr = array();
    if (filter($sql) == 0) {
        $sql = $pdo->prepare($sql);
        $sql->execute();
        $arr = $sql->fetchAll(PDO::FETCH_ASSOC);
    } else {
        exit();
    }
}

function dbUpdateSS ($key, $value, $date) {
    global $pdo;
    $sql = "UPDATE serverstats SET $key = :value WHERE date = :date";
    $stmt = $pdo->prepare($sql);

    if (filter($key) == 0 && filter($value) == 1 && filter($date) == 0) {
        $stmt->bindParam(':key', $key, PDO::PARAM_STR);
        $stmt->bindParam(':value', $value, PDO::PARAM_NULL);
        $stmt->bindParam(':date', $date, PDO::PARAM_STR);
    } elseif (filter($key) == 0 && filter($value) == 0 && filter($date) == 0) {
        $stmt->bindParam(':key', $key, PDO::PARAM_STR);
        $stmt->bindParam(':value', $value, PDO::PARAM_STR);
        $stmt->bindParam(':date', $date, PDO::PARAM_STR);
    } else {
        exit(1);
    }

    $stmt->execute();
    $stmt = null;
}

?>