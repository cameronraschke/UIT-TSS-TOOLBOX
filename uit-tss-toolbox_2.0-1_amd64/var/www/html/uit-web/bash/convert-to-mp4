#!/bin/bash

if [[ $1 != "UIT_WEB_SVC_PASSWD" ]]; then
    exit 1;
fi

filename=$2
compression=$3

if [[ $compression == "low-quality" ]]; then
    ffmpeg -loglevel quiet -hide_banner -nostats -i "/var/www/html/uit-web/transcode/${filename}" -c:a aac -vcodec libx264 -crf 28 -movflags frag_keyframe+empty_moov -f mp4 pipe:1 | base64;
fi
if [[ $compression == "normal-quality" ]]; then
    ffmpeg -loglevel quiet -hide_banner -nostats -i "/var/www/html/uit-web/transcode/${filename}" -c:a aac -movflags frag_keyframe+empty_moov -f mp4 pipe:1 | base64;
fi